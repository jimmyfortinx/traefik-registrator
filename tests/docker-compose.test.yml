services:
  tests:
    image: golang:1.24-alpine
    working_dir: /workspace
    volumes:
      - ../:/workspace
      - /var/run/docker.sock:/var/run/docker.sock
    environment:
      RUN_COMPOSE_TESTS: "1"
    entrypoint:
      - /bin/sh
      - -ec
      - apk add --no-cache docker-cli docker-cli-compose && go test -v ./...
